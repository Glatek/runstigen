import"./components/lantmateriet-karta.js";import"./components/folklore-article.js";const u=L.icon({iconUrl:"img/overnight-cabin.svg",iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-20]}),d=L.icon({iconUrl:"img/undefined.svg",iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-20]});function S(o=navigator.userAgent){const n=o.match(/iPad/i),e=o.match(/iPhone/i),t=o.match(/Safari/i);return!!(n||e||t)}function l(o){return o.properties.type==="SVENSKA_GODS_OCH_G\xC5RDAR"?u:d}function g(o){const n=new URL(o,document.location.href);return n.pathname.substring(0,n.pathname.lastIndexOf("/"))}async function m(o,n,e){const t=new URL(g(e)+"/"+o.properties.data,document.location.href);if(o.properties){const i=[];if("data"in o.properties){n.on("click",()=>{document.dispatchEvent(new CustomEvent("info:display",{detail:{url:t}}))},!1);return}o.properties.title&&i.push(`<b>${o.properties.title}</b>`),o.properties.type!=="FARM"&&i.push(`Glaskogennummer: ${o.properties.glaskogenNumber||"ok\xE4nt"}`),o.properties.bedCount&&i.push(`B\xE4ddar: ${o.properties.bedCount}`),o.properties.desc&&i.push(`${o.properties.desc}`),n.bindPopup(i.join("<br>"))}}async function h({map:o,path:n,color:e,fillColor:t}){const a=await(await fetch(n)).json(),p=(c,s)=>L.marker(s,{icon:l(c)}),r=L.markerClusterGroup();return L.geoJSON(a,{pointToLayer:p,onEachFeature:(c,s)=>m(c,s,n)}).addTo(r),r.addTo(o),r}const f=o=>h({map:o,path:"data/sgog/s/collection.json"});async function b(o){const n=await f(o),e=new L.featureGroup([...n.getLayers()]);o.fitBounds(e.getBounds())}document.querySelector("header button").addEventListener("click",()=>{const o=document.querySelector("glaskogencard-buy");o.getAttribute("open")?o.removeAttribute("open"):o.setAttribute("open","")}),document.addEventListener("map:ready",()=>{const{leafletMap:o}=document.querySelector("lantmateriet-karta");b(o),o.on("click",function(n){const{lat:e,lng:t}=o.mouseEventToLatLng(n.originalEvent);console.log(JSON.stringify([t,e]))})});
