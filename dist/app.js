import"leaflet";import"leaflet.markercluster";import"./components/lantmateriet-karta.js";import"./components/folklore-article.js";const u=L.icon({iconUrl:"img/overnight-cabin.svg",iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-20]}),d=L.icon({iconUrl:"img/undefined.svg",iconSize:[32,32],iconAnchor:[16,16],popupAnchor:[0,-20]});function C(o=navigator.userAgent){const n=o.match(/iPad/i),t=o.match(/iPhone/i),e=o.match(/Safari/i);return!!(n||t||e)}function l(o){return o.properties.type==="SVENSKA_GODS_OCH_G\xC5RDAR"?u:d}function m(o){const n=new URL(o,document.location.href);return n.pathname.substring(0,n.pathname.lastIndexOf("/"))}async function g(o,n,t){const e=new URL(m(t)+"/"+o.properties.data,document.location.href);if(o.properties){const i=[];if("data"in o.properties){n.on("click",()=>{document.dispatchEvent(new CustomEvent("info:display",{detail:{url:e}}))},!1);return}o.properties.title&&i.push(`<b>${o.properties.title}</b>`),o.properties.type!=="FARM"&&i.push(`Glaskogennummer: ${o.properties.glaskogenNumber||"ok\xE4nt"}`),o.properties.bedCount&&i.push(`B\xE4ddar: ${o.properties.bedCount}`),o.properties.desc&&i.push(`${o.properties.desc}`),n.bindPopup(i.join("<br>"))}}async function h({map:o,path:n,color:t,fillColor:e}){const a=await(await fetch(n)).json(),p=(s,c)=>L.marker(c,{icon:l(s)}),r=L.markerClusterGroup();return L.geoJSON(a,{pointToLayer:p,onEachFeature:(s,c)=>g(s,c,n)}).addTo(r),r.addTo(o),r}const f=o=>h({map:o,path:"data/sgog/s/collection.json"});async function k(o){const n=await f(o),t=new L.featureGroup([...n.getLayers()]);o.fitBounds(t.getBounds())}document.addEventListener("map:ready",()=>{const{leafletMap:o}=document.querySelector("lantmateriet-karta");k(o),o.on("click",function(n){const{lat:t,lng:e}=o.mouseEventToLatLng(n.originalEvent);console.log(JSON.stringify([e,t]))})});
